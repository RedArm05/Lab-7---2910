This took embarrassingly longer then I thought but the tests pass.
